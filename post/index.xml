<?xml version="1.0" encoding="utf-8" ?>
<?xml-stylesheet type="text/xsl" href="http://ttbt.work/xml/base.min.xml" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Posts on 通通不同-博客</title>
    <link>http://ttbt.work/post/</link>
    <description>Recent content in Posts on 通通不同-博客</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>cn-zh</language>
    <lastBuildDate>Tue, 21 Mar 2023 15:23:06 +0800</lastBuildDate>
    <atom:link href="http://ttbt.work/post/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Linux_create_user</title>
      <link>http://ttbt.work/post/linux_create_user/</link>
      <pubDate>Tue, 21 Mar 2023 15:23:06 +0800</pubDate>
      <guid>http://ttbt.work/post/linux_create_user/</guid>
      <description>&lt;h1 id=&#34;linux创建新用户&#34;&gt;
  &lt;a class=&#34;Heading-link u-clickable&#34; href=&#34;http://ttbt.work/post/linux_create_user/#linux%e5%88%9b%e5%bb%ba%e6%96%b0%e7%94%a8%e6%88%b7&#34;&gt;linux创建新用户&lt;/a&gt;
&lt;/h1&gt;

&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;useradd -d /home/test -m test&lt;/code&gt;&lt;/pre&gt;
&lt;blockquote&gt;
&lt;p&gt;useradd：创建新用户&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;-d 指定目录文件夹&lt;/li&gt;
&lt;li&gt;-m 新账号名&lt;/li&gt;
&lt;li&gt;-c comment 指定一段注释性描述&lt;/li&gt;
&lt;li&gt;-d 目录 指定用户主目录，如果此目录不存在，则同时使用-m选项，可以创建主目录&lt;/li&gt;
&lt;li&gt;-g 用户组 指定用户所属的用户组&lt;/li&gt;
&lt;li&gt;-G 用户组，用户组 指定用户所属的附加组&lt;/li&gt;
&lt;li&gt;-s Shell文件 指定用户的登录Shell&lt;/li&gt;
&lt;li&gt;-u 用户号 指定用户的用户号，如果同时有-o选项，则可以重复使用其他用户的标识号&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;设置密码&#34;&gt;
  &lt;a class=&#34;Heading-link u-clickable&#34; href=&#34;http://ttbt.work/post/linux_create_user/#%e8%ae%be%e7%bd%ae%e5%af%86%e7%a0%81&#34;&gt;设置密码&lt;/a&gt;
&lt;/h1&gt;

&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;passwd test&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;会提示你输入两次密码&lt;/p&gt;
&lt;h1 id=&#34;删除账号&#34;&gt;
  &lt;a class=&#34;Heading-link u-clickable&#34; href=&#34;http://ttbt.work/post/linux_create_user/#%e5%88%a0%e9%99%a4%e8%b4%a6%e5%8f%b7&#34;&gt;删除账号&lt;/a&gt;
&lt;/h1&gt;

&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;userdel test&lt;/code&gt;&lt;/pre&gt;
</description>
    </item>
    <item>
      <title>服务器运维监控命令汇总</title>
      <link>http://ttbt.work/post/system_monitor/</link>
      <pubDate>Tue, 21 Mar 2023 14:25:13 +0800</pubDate>
      <guid>http://ttbt.work/post/system_monitor/</guid>
      <description>&lt;h1 id=&#34;who命令&#34;&gt;
  &lt;a class=&#34;Heading-link u-clickable&#34; href=&#34;http://ttbt.work/post/system_monitor/#who%e5%91%bd%e4%bb%a4&#34;&gt;who命令&lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;输出信息包括 用户名，终端类型，登录日期，访问IP
-H 打印列标题
-b 查看上次启动时间&lt;/p&gt;

&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;who [-H|-b]
who [-H|-b] /var/log/wtmp&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;查看命令历史&#34;&gt;
  &lt;a class=&#34;Heading-link u-clickable&#34; href=&#34;http://ttbt.work/post/system_monitor/#%e6%9f%a5%e7%9c%8b%e5%91%bd%e4%bb%a4%e5%8e%86%e5%8f%b2&#34;&gt;查看命令历史&lt;/a&gt;
&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;每个用户都有一份命令历史记录&lt;/li&gt;
&lt;li&gt;查看$HOME/.bash_history&lt;/li&gt;
&lt;li&gt;或者在终端输入： history&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;last命令&#34;&gt;
  &lt;a class=&#34;Heading-link u-clickable&#34; href=&#34;http://ttbt.work/post/system_monitor/#last%e5%91%bd%e4%bb%a4&#34;&gt;last命令&lt;/a&gt;
&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;查看用户登录历史&lt;/li&gt;
&lt;li&gt;命令会读取 /var/log/wtmp文件；&lt;/li&gt;
&lt;li&gt;/var/log/btmp可以显示远程登陆信息。&lt;/li&gt;
&lt;li&gt;last默认打印所有用户的登陆信息。&lt;/li&gt;
&lt;li&gt;如果想打印某个用户的登陆信息，可以使用&lt;/li&gt;
&lt;li&gt;last 用户名&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;选项：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;（1）-x：显示系统开关机以及执行等级信息&lt;/li&gt;
&lt;li&gt;（2）-a：将登陆ip显示在最后一行&lt;/li&gt;
&lt;li&gt;（3）-f ：读取特定文件，可以选择 -f /var/log/btmp文件&lt;/li&gt;
&lt;li&gt;（4）-d：将IP地址转换为主机名&lt;/li&gt;
&lt;li&gt;（5）-n：设置列出名单的显示列数&lt;/li&gt;
&lt;li&gt;（6）-t：查看指定时间的用户登录历史&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;lastlog命令&#34;&gt;
  &lt;a class=&#34;Heading-link u-clickable&#34; href=&#34;http://ttbt.work/post/system_monitor/#lastlog%e5%91%bd%e4%bb%a4&#34;&gt;lastlog命令&lt;/a&gt;
&lt;/h1&gt;
&lt;blockquote&gt;
&lt;p&gt;查看所有用户最近一次登录历史&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;命令将读取/var/log/lastlog文件；用户排列顺序按照/etc/passwd中的顺序&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;选项：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;（1） -u：查看某个用户的最后一次登陆历史&lt;/li&gt;
&lt;li&gt;（2） -t：查看最近几天之内的用户登录历史&lt;/li&gt;
&lt;li&gt;（3） -b：查看指定天数之前的用户登录历史&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;ac命令&#34;&gt;
  &lt;a class=&#34;Heading-link u-clickable&#34; href=&#34;http://ttbt.work/post/system_monitor/#ac%e5%91%bd%e4%bb%a4&#34;&gt;ac命令&lt;/a&gt;
&lt;/h1&gt;
&lt;blockquote&gt;
&lt;p&gt;根据/var/log/wtmp文件中的登陆和退出时间报告用户连接的时间（小时），默认输出报告总时间&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;（1）-p：显示每个用户的连接时间&lt;/li&gt;
&lt;li&gt;（2）-d：显示每天的连接时间&lt;/li&gt;
&lt;li&gt;（3）-y：显示年份，和-d配合使用&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    <item>
      <title>Supervisor管理GO程序</title>
      <link>http://ttbt.work/post/supervisor/</link>
      <pubDate>Tue, 21 Mar 2023 14:04:34 +0800</pubDate>
      <guid>http://ttbt.work/post/supervisor/</guid>
      <description>&lt;h1 id=&#34;安装&#34;&gt;
  &lt;a class=&#34;Heading-link u-clickable&#34; href=&#34;http://ttbt.work/post/supervisor/#%e5%ae%89%e8%a3%85&#34;&gt;安装&lt;/a&gt;
&lt;/h1&gt;

&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;apt-get install supervisor&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h1 id=&#34;使用说明&#34;&gt;
  &lt;a class=&#34;Heading-link u-clickable&#34; href=&#34;http://ttbt.work/post/supervisor/#%e4%bd%bf%e7%94%a8%e8%af%b4%e6%98%8e&#34;&gt;使用说明&lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;supervisor配置文件：/etc/supervisor/supervisord.conf
子进程配置文件路径：/etc/supervisor/conf.d/&lt;/p&gt;
&lt;h1 id=&#34;常用命令说明&#34;&gt;
  &lt;a class=&#34;Heading-link u-clickable&#34; href=&#34;http://ttbt.work/post/supervisor/#%e5%b8%b8%e7%94%a8%e5%91%bd%e4%bb%a4%e8%af%b4%e6%98%8e&#34;&gt;常用命令说明&lt;/a&gt;
&lt;/h1&gt;

&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# 查看所有进程的状态&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;supervisorctl status
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# 停止iot&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;supervisorctl stop iot
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# 启动iot&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;supervisorctl start iot
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# 重启iot&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;supervisorctl restart iot
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# 配置文件修改后使用该命令加载新的配置&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;supervisorctl update
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# 重新启动配置中的所有程序&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;supervisorctl reload&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h1 id=&#34;配置go进程&#34;&gt;
  &lt;a class=&#34;Heading-link u-clickable&#34; href=&#34;http://ttbt.work/post/supervisor/#%e9%85%8d%e7%bd%aego%e8%bf%9b%e7%a8%8b&#34;&gt;配置GO进程&lt;/a&gt;
&lt;/h1&gt;

&lt;pre tabindex=&#34;0&#34;&gt;&lt;code class=&#34;language-conf&#34; data-lang=&#34;conf&#34;&gt;[program:iot]
# 脚本目录
directory=/opt/iot
# 脚本执行命令
command=/opt/iot/main
# 日志输出
stdout_logfile=/opt/iot/supervisor/main.log
# supervisor启动的时候是否随着同时启动，默认True
autostart=true
autorestart=true
startsecs=5
priority=1
stopasgroup=true
killasgroup=true&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;常见问题&#34;&gt;
  &lt;a class=&#34;Heading-link u-clickable&#34; href=&#34;http://ttbt.work/post/supervisor/#%e5%b8%b8%e8%a7%81%e9%97%ae%e9%a2%98&#34;&gt;常见问题&lt;/a&gt;
&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;unix:///var/run/supervisor.sock no such file&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;问题描述：安装好supervisor没有开启服务直接使用supervisorctl报的错&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;解决办法：supervisord -c /etc/supervisord.conf&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;command中指定的进程已经起来，但supervisor还不断重启&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;问题描述：command中启动方式为后台启动，导致识别不到pid，然后不断重启，这里使用的是elasticsearch，command指定的是$path/bin/elasticsearch -d&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;解决办法：supervisor无法检测后台启动进程的pid，而supervisor本身就是后台启动守护进程，因此不用担心这个&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;启动了多个supervisord服务，导致无法正常关闭服务&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;问题描述：在运行supervisord -c /etc/supervisord.conf之前，直接运行过supervisord -c /etc/supervisord.d/xx.conf导致有些进程被多个superviord管理，无法正常关闭进程。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;解决办法：使用ps -fe | grep supervisord查看所有启动过的supervisord服务，kill相关的进程。&lt;/p&gt;
&lt;/blockquote&gt;
</description>
    </item>
    <item>
      <title>配置博客文档</title>
      <link>http://ttbt.work/post/config/</link>
      <pubDate>Sat, 11 Mar 2023 23:16:37 +0800</pubDate>
      <guid>http://ttbt.work/post/config/</guid>
      <description>&lt;h1 id=&#34;安装&#34;&gt;
  &lt;a class=&#34;Heading-link u-clickable&#34; href=&#34;http://ttbt.work/post/config/#%e5%ae%89%e8%a3%85&#34;&gt;安装&lt;/a&gt;
&lt;/h1&gt;

&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;$ brew install hugo&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;生成博客&#34;&gt;
  &lt;a class=&#34;Heading-link u-clickable&#34; href=&#34;http://ttbt.work/post/config/#%e7%94%9f%e6%88%90%e5%8d%9a%e5%ae%a2&#34;&gt;生成博客&lt;/a&gt;
&lt;/h1&gt;

&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;$ hugo new site myblog&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;安装皮肤&#34;&gt;
  &lt;a class=&#34;Heading-link u-clickable&#34; href=&#34;http://ttbt.work/post/config/#%e5%ae%89%e8%a3%85%e7%9a%ae%e8%82%a4&#34;&gt;安装皮肤&lt;/a&gt;
&lt;/h1&gt;

&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;$ cd themes
$ git clone https://github.com/de-souza/hugo-flex.git&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;创建文章&#34;&gt;
  &lt;a class=&#34;Heading-link u-clickable&#34; href=&#34;http://ttbt.work/post/config/#%e5%88%9b%e5%bb%ba%e6%96%87%e7%ab%a0&#34;&gt;创建文章&lt;/a&gt;
&lt;/h1&gt;

&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;$ hugo new post/config.md&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;运行hugo&#34;&gt;
  &lt;a class=&#34;Heading-link u-clickable&#34; href=&#34;http://ttbt.work/post/config/#%e8%bf%90%e8%a1%8chugo&#34;&gt;运行hugo&lt;/a&gt;
&lt;/h1&gt;

&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;hugo server -D --theme=hugo-flex --buildDrafts&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;部署&#34;&gt;
  &lt;a class=&#34;Heading-link u-clickable&#34; href=&#34;http://ttbt.work/post/config/#%e9%83%a8%e7%bd%b2&#34;&gt;部署&lt;/a&gt;
&lt;/h1&gt;

&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;hugo --theme=hugo-flex --baseUrl=&amp;#34;http://ttbt.work&amp;#34; --buildDrafts&lt;/code&gt;&lt;/pre&gt;
</description>
    </item>
  </channel>
</rss>
